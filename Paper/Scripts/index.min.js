

//Work with AngularJS

////*** initial module
var helloApplication = angular.module('helloApplication', []);
//var crudBaseUrl = '@Url.Content("~/hello/") ';

//alert('@ViewBag.Hello');
//*** controller

helloApplication.controller('helloController', function ($scope, $http) {

    //app logic here
    {

    }

    //default value

    $scope.selectSignalL1 = "pretimed";
    $scope.selectSignalL2 = "pretimed";
    $scope.selectSignalL3 = "pretimed";
    $scope.selectSignalL4 = "pretimed";
    $scope.currentTab = 1;

    //*** $scope is a parameter in controller, it is dynamic properties, we can assign values to it, which can be later can be accessed in UI element
    $scope.helloMessage = "Hello World with AngularJS on " + (new Date()).toLocaleString();
    //$scope.helloPicture = "/content/image/blog2image.png"

    $scope.clickInput = function () {

        //progressbar
        NProgress.configure({ showSpinner: true, parent: "#progress1" });
        NProgress.start();

        //object general
        var Genr =
            {
                Analyst: $scope.textAnalyst,
                Company: $scope.textCompany,
                Intersect: $scope.textIntersect,
                Area: $scope.textArea,
                Date: $scope.selectDate + "/" + $scope.selectMonth + "/" + $scope.selectYear,

                Period: $scope.selectStart + "-" + $scope.selectFinish,

                StationFlow: $scope.textStationFlow,
                Crosswork: $scope.textCrosswork,

                HeavyL1L2: $scope.textHeavyL1L2,
                HeavyL3L4: $scope.textHeavyL3L4,
            };

        //array geometric
        var GeomeList = [];
        var GeomeL1 =
            {
                Grade: $scope.textGradeL1,
                Width: $scope.textWidthL1,
                Lane: $scope.selectLaneL1,
            };
        GeomeList.push(GeomeL1);

        var GeomeL2 =
        {
            Grade: $scope.textGradeL2,
            Width: $scope.textWidthL2,
            Lane: $scope.selectLaneL2,
        };

        GeomeList.push(GeomeL2);

        var GeomeL3 =
        {
            Grade: $scope.textGradeL3,
            Width: $scope.textWidthL3,
            Lane: $scope.selectLaneL3,
        };
        GeomeList.push(GeomeL3);

        var GeomeL4 =
        {
            Grade: $scope.textGradeL4,
            Width: $scope.textWidthL4,
            Lane: $scope.selectLaneL4,
        };
        GeomeList.push(GeomeL4);

        //array volumn
        var VolmList = [];
        var VolmL1 = 
            {
                VolumnLT: $scope.textVolumnLTL1,
                VolumnTH: $scope.textVolumnTHL1,
                VolumnRT: $scope.textVolumnRTL1,

                LaneGroupLT: $scope.selectLaneGroupL1LT,
                LaneGroupTH: $scope.selectLaneGroupL1TH,
                LaneGroupRT: $scope.selectLaneGroupL1RT,

                PeakHourFactor: $scope.textPeakHourL1,
                SignalType: $scope.selectSignalL1,
                StartLostTime: $scope.textStartLostTimeL1,
                EffectGreenTime: $scope.textEffectGreenTimeL1,
                ArrivalType: $scope.textArrivalTypeL1,

                ApprochPedestrian: $scope.textPedestrianL1,
                ApprochBicycle: $scope.textBicycleL1,
                IsParking: $scope.selectParkingL1,
                ParkingVolumn: $scope.textParkingL1,

                Bus: $scope.textBusL1,
                MinTimePedestrian: $scope.textMinTimePedestrianL1,

                LaneGroup: $scope.selectLaneGroupL1,

                LeftTurnLane: $scope.selectLeftTurnLaneL1,
                LeftTurnPhase: $scope.selectLeftTurnPhaseL1,

                RightTurnLane: $scope.selectRightTurnLaneL1,
                RightTurnPhase: $scope.selectRightTurnPhaseL1,
            };
        VolmList.push(VolmL1);

        var VolmL2 =
        {
            VolumnLT: $scope.textVolumnLTL2,
            VolumnTH: $scope.textVolumnTHL2,
            VolumnRT: $scope.textVolumnRTL2,

            LaneGroupLT: $scope.selectLaneGroupL2LT,
            LaneGroupTH: $scope.selectLaneGroupL2TH,
            LaneGroupRT: $scope.selectLaneGroupL2RT,

            PeakHourFactor: $scope.textPeakHourL2,
            SignalType: $scope.selectSignalL2,
            StartLostTime: $scope.textStartLostTimeL2,
            EffectGreenTime: $scope.textEffectGreenTimeL2,
            ArrivalType: $scope.textArrivalTypeL2,

            ApprochPedestrian: $scope.textPedestrianL2,
            ApprochBicycle: $scope.textBicycleL2,
            IsParking: $scope.selectParkingL2,
            ParkingVolumn: $scope.textParkingL2,

            Bus: $scope.textBusL2,
            MinTimePedestrian: $scope.textMinTimePedestrianL2,

            LaneGroup: $scope.selectLaneGroupL2,

            LeftTurnLane: $scope.selectLeftTurnLaneL2,
            LeftTurnPhase: $scope.selectLeftTurnPhaseL2,

            RightTurnLane: $scope.selectRightTurnLaneL2,
            RightTurnPhase: $scope.selectRightTurnPhaseL2,
        };
        VolmList.push(VolmL2);

        var VolmL3 =
        {
            VolumnLT: $scope.textVolumnLTL3,
            VolumnTH: $scope.textVolumnTHL3,
            VolumnRT: $scope.textVolumnRTL3,

            LaneGroupLT: $scope.selectLaneGroupL3LT,
            LaneGroupTH: $scope.selectLaneGroupL3TH,
            LaneGroupRT: $scope.selectLaneGroupL3RT,

            PeakHourFactor: $scope.textPeakHourL3,
            SignalType: $scope.selectSignalL3,
            StartLostTime: $scope.textStartLostTimeL3,
            EffectGreenTime: $scope.textEffectGreenTimeL3,
            ArrivalType: $scope.textArrivalTypeL3,

            ApprochPedestrian: $scope.textPedestrianL3,
            ApprochBicycle: $scope.textBicycleL3,
            IsParking: $scope.selectParkingL3,
            ParkingVolumn: $scope.textParkingL3,

            Bus: $scope.textBusL3,
            MinTimePedestrian: $scope.textMinTimePedestrianL3,

            LaneGroup: $scope.selectLaneGroupL3,

            LeftTurnLane: $scope.selectLeftTurnLaneL3,
            LeftTurnPhase: $scope.selectLeftTurnPhaseL3,

            RightTurnLane: $scope.selectRightTurnLaneL3,
            RightTurnPhase: $scope.selectRightTurnPhaseL3,
        };
        VolmList.push(VolmL3);


        var VolmL4 =
        {
            VolumnLT: $scope.textVolumnLTL4,
            VolumnTH: $scope.textVolumnTHL4,
            VolumnRT: $scope.textVolumnRTL4,

            LaneGroupLT: $scope.selectLaneGroupL4LT,
            LaneGroupTH: $scope.selectLaneGroupL4TH,
            LaneGroupRT: $scope.selectLaneGroupL4RT,

            PeakHourFactor: $scope.textPeakHourL4,
            SignalType: $scope.selectSignalL4,
            StartLostTime: $scope.textStartLostTimeL4,
            EffectGreenTime: $scope.textEffectGreenTimeL4,
            ArrivalType: $scope.textArrivalTypeL4,

            ApprochPedestrian: $scope.textPedestrianL4,
            ApprochBicycle: $scope.textBicycleL4,
            IsParking: $scope.selectParkingL4,
            ParkingVolumn: $scope.textParkingL4,

            Bus: $scope.textBusL4,
            MinTimePedestrian: $scope.textMinTimePedestrianL4,

            LaneGroup: $scope.selectLaneGroupL4,

            LeftTurnLane: $scope.selectLeftTurnLaneL4,
            LeftTurnPhase: $scope.selectLeftTurnPhaseL4,

            RightTurnLane: $scope.selectRightTurnLaneL4,
            RightTurnPhase: $scope.selectRightTurnPhaseL4,
        };
        VolmList.push(VolmL4);

        //array signal phase
        var SignrList = [];
        var SignrP1 =
            {
                Leg: $scope.selectLegP1,
                TrafficFlowDirection: $scope.selectFlowP1,
                TimeY: $scope.textTimeYP1,
                TimeG: $scope.textTimeGP1,
            };
        SignrList.push(SignrP1);

        var SignrP2 =
            {
                Leg: $scope.selectLegP2,
                TrafficFlowDirection: $scope.selectFlowP2,
                TimeY: $scope.textTimeYP2,
                TimeG: $scope.textTimeGP2,
            };
        SignrList.push(SignrP2);

        var SignrP3 =
            {
                Leg: $scope.selectLegP3,
                TrafficFlowDirection: $scope.selectFlowP3,
                TimeY: $scope.textTimeYP3,
                TimeG: $scope.textTimeGP3,
            };
            SignrList.push(SignrP3);

        var SignrP4 =
            {
                Leg: $scope.selectLegP4,
                TrafficFlowDirection: $scope.selectFlowP4,
                TimeY: $scope.textTimeYP4,
                TimeG: $scope.textTimeGP4,
            };
        SignrList.push(SignrP4);

        ///5
        var SignrP5 =
            {
                Leg: $scope.selectLegP5,
                TrafficFlowDirection: $scope.selectFlowP5,
                TimeY: $scope.textTimeYP5,
                TimeG: $scope.textTimeGP5,
            };
        SignrList.push(SignrP5);


        var SignrP6 =
            {
                Leg: $scope.selectLegP6,
                TrafficFlowDirection: $scope.selectFlowP6,
                TimeY: $scope.textTimeYP6,
                TimeG: $scope.textTimeGP6,
            };
        SignrList.push(SignrP6);


        var SignrP7 =
            {
                Leg: $scope.selectLegP7,
                TrafficFlowDirection: $scope.selectFlowP7,
                TimeY: $scope.textTimeYP7,
                TimeG: $scope.textTimeGP7,
            };
        SignrList.push(SignrP7);


        var SignrP8 =
            {
                Leg: $scope.selectLegP8,
                TrafficFlowDirection: $scope.selectFlowP8,
                TimeY: $scope.textTimeYP8,
                TimeG: $scope.textTimeGP8,
            };

        SignrList.push(SignrP8);

        //submit data to api server
        var postData =
        {
            "genr": Genr,
            "geolist": GeomeList,
            "volmlist": VolmList,
            "signllist": SignrList,
        };


        //alert($scope.selectLaneGroupL1LT); return;
    
        $http({
            method: "POST",
            url: "/api/fluid/volumn",
            data: postData,
            //contentType: "application/json"

        }).success(function (response) {

            $scope.volumns = response;

            //loading complete


            //focus tab
            $scope.currentTab = 2;

            NProgress.done();

            showtab("sh2")
           // alert("OK");

        }).error(function () {

            $scope.volumns = null;

            NProgress.done();
            alert("FAIL");
        });

    }
    //end click function




});